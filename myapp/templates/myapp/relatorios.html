{% extends "base_generic.html" %}

{% block content %}
  <div class="obj-list-container">
    <h1>Relatórios</h1>
    
    <div class="table-responsive obj-list-table-container">
      
      
      
        <table class="table obj-list-table" style="width:100%">

            
            
          <tr>
              <th>Tipo de relatório</th>
              

          </tr>
          <tr>
              <td>Lista de Clientes</td>
              <td></td>
              <td></td>
              <td><a class="btn btn-warning"href="{% url 'relatorio-clientes' %}"> Gerar PDF</a></td>
          </tr>
          <tr>
              <td>Lista de Representadas</td>
              <td></td>
              <td></td>
              <td><a class="btn btn-warning"href="{% url 'relatorio-representadas' %}"> Gerar PDF</a></td>
          </tr>
          <tr>
            <td>Lista de Produtos por Representadas</td>
            <td></td>
            <td>
              <label>Representada</label>
              <select id="representada-select" class="form-control">
                <option  value="" selected="selected">------</option>
                {% for r in representadas %}
                 <option value="{{r.id}}">{{r}}</option>
                {% endfor %}
              </select>
            </td>
            <td><a id="gerar_representada" class="btn btn-warning" href="{% url 'relatorio-produtos-por-repr'  %}"> Gerar PDF</a></td>
          </tr>
          
          <tr>
            <td>Lista de Clientes por Produto</td>
            <td></td>
            <td>
              <label>Produto</label>
              <select id="produto-select" class="form-control">
                <option  value="" selected="selected">------</option>
                {% for r in produtos %}
                 <option value="{{r.id}}">{{r}}</option>
                {% endfor %}
              </select>
            </td>
            <td><a id="gerar_cliente_prod" class="btn btn-warning" href="{% url 'relatorio-clientes-por-prod'  %}"> Gerar PDF</a></td>
          </tr>

          <tr>
            <td>Lista de Comissão por Representada</td>
            <td>
              <div class="form-row">
                <div class="form-group col-6">
                  <label>Início</label>
                  <input id="comissao_dateFrom" class="form-control" />
                </div>
                <div class="form-group col-6">
                  <label>Fim</label>
                  <input id="comissao_dateTo" class="form-control" />
                </div>
              </div>
            </td>
            <td>
              <label>Representada</label>
              <select id="comissao-repr-select" class="form-control">
                <option  value="" selected="selected">------</option>
                {% for r in representadas %}
                 <option value="{{r.id}}">{{r}}</option>
                {% endfor %}
              </select>
            </td>
            <td><a id="gerar_comissao_repr" class="btn btn-warning" href="{% url 'relatorio-comissao-por-repr'  %}"> Gerar PDF</a></td>
          </tr>

      </table>
    </div>
  </div>
  
  <script>
    $('#representada-select').on('change', function(){
        split = $('#gerar_representada').attr('href').split('/');
        url = ""
        for(i = 0; i < split.length -1; i++){
          url += split[i]+'/'
        }
        url += $('#representada-select').val();
        $('#gerar_representada').attr('href',url);
    });

    $('#produto-select').on('change', function(){
        split = $('#gerar_cliente_prod').attr('href').split('/');
        url = ""
        for(i = 0; i < split.length -1; i++){
          url += split[i]+'/'
        }
        url += $('#produto-select').val();
        $('#gerar_cliente_prod').attr('href',url);
    });

    $('#comissao-repr-select').on('change', function(){
        split = $('#gerar_comissao_repr').attr('href').split('/');
        url = ""
        for(i = 0; i < 4; i++){
          console.log("I: "+i)
          url += split[i]+'/'
        }
        url += $('#comissao-repr-select').val();
        
        url += "?dateFrom="+$('#comissao_dateFrom').val()+"&dateTo="+$('#comissao_dateTo').val();
        
        $('#gerar_comissao_repr').attr('href',url);
    });

    $('#gerar_comissao_repr').on('click', function(){
        if($('#comissao-repr-select').val() == ""){
            alert("Selecione uma representada.");
        }
    });

    $('#gerar_cliente_prod').on('click', function(){
        if($('#produto-select').val() == ""){
            alert("Selecione um produto.");
        }
    });

    $( function() {
        $( "#comissao_dateFrom" ).datepicker();
        $( "#comissao_dateTo" ).datepicker();
    } );
    $('#representada-select').select2();
    $('#produto-select').select2();

    

  </script>
{% endblock %}

